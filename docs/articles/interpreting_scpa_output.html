<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interpreting SCPA output • Single Cell Pathway Analysis (SCPA)</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Interpreting SCPA output">
<meta property="og:description" content="SCPA">
<meta property="og:image" content="jackbibby1.github.io/SCPA/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-W1XR84YEPZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-W1XR84YEPZ');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Single Cell Pathway Analysis (SCPA)</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">General information</li>
    <li>
      <a href="../articles/interpreting_scpa_output.html">Interpreting the SCPA output</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Generic example</li>
    <li>
      <a href="../articles/quick_start.html">Quick start</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Interacting with gene sets</li>
    <li>
      <a href="../articles/using_gene_sets.html">Using gene sets</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Specific examples</li>
    <li>
      <a href="../articles/comparing_two_populations.html">Comparing two populations</a>
    </li>
    <li>
      <a href="../articles/seurat_comparison.html">Seurat/SingleCellExperiment comparison</a>
    </li>
    <li>
      <a href="../articles/pseudotime.html">Comparing across pseudotime</a>
    </li>
    <li>
      <a href="../articles/systematic_tissue_comparison.html">Systematic comparisons of cells across tissue</a>
    </li>
    <li>
      <a href="../articles/disease_comparison.html">Systems level pathway analysis in disease</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Visualisation</li>
    <li>
      <a href="../articles/visualisation.html">Visualising SCPA output</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jackbibby1/SCPA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interpreting SCPA output</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jackbibby1/SCPA/blob/HEAD/vignettes/interpreting_scpa_output.Rmd" class="external-link"><code>vignettes/interpreting_scpa_output.Rmd</code></a></small>
      <div class="hidden name"><code>interpreting_scpa_output.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="basic-output-from-scpa">Basic output from SCPA<a class="anchor" aria-label="anchor" href="#basic-output-from-scpa"></a>
</h3>
<p>The output from SCPA provides 4-5 columns, depending on the type of
comparison. These will be 1) your pathways 2) raw pval 3) adjusted pval
4) qval, and, if a two-sample comparison is done 5) fold change. Here is
an example output:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scpa_out</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               Pathway          Pval      adjPval     qval</span></span>
<span><span class="co">#&gt; 32            HALLMARK_MYC_TARGETS_V1 5.788383e-101 2.894192e-99 9.926655</span></span>
<span><span class="co">#&gt; 2        HALLMARK_ALLOGRAFT_REJECTION  7.532277e-93 3.766139e-91 9.509159</span></span>
<span><span class="co">#&gt; 31          HALLMARK_MTORC1_SIGNALING  7.532277e-93 3.766139e-91 9.509159</span></span>
<span><span class="co">#&gt; 36 HALLMARK_OXIDATIVE_PHOSPHORYLATION  1.061001e-89 5.305003e-88 9.342126</span></span>
<span><span class="co">#&gt; 23       HALLMARK_IL2_STAT5_SIGNALING  1.315549e-86 6.577745e-85 9.175071</span></span>
<span><span class="co">#&gt; 33            HALLMARK_MYC_TARGETS_V2  1.435838e-83 7.179192e-82 9.007992</span></span>
<span><span class="co">#&gt; 13               HALLMARK_E2F_TARGETS  4.522036e-82 2.261018e-80 8.924444</span></span>
<span><span class="co">#&gt; 27 HALLMARK_INTERFERON_GAMMA_RESPONSE  1.379483e-80 6.897414e-79 8.840889</span></span>
<span><span class="co">#&gt; 48            HALLMARK_UV_RESPONSE_UP  1.379483e-80 6.897414e-79 8.840889</span></span>
<span><span class="co">#&gt; 18            HALLMARK_G2M_CHECKPOINT  4.076176e-79 2.038088e-77 8.757327</span></span>
<span><span class="co">#&gt;           FC</span></span>
<span><span class="co">#&gt; 32 -87.81108</span></span>
<span><span class="co">#&gt; 2  -21.07656</span></span>
<span><span class="co">#&gt; 31 -45.82991</span></span>
<span><span class="co">#&gt; 36 -47.98635</span></span>
<span><span class="co">#&gt; 23 -20.23701</span></span>
<span><span class="co">#&gt; 33 -20.71347</span></span>
<span><span class="co">#&gt; 13 -31.36869</span></span>
<span><span class="co">#&gt; 27 -13.62249</span></span>
<span><span class="co">#&gt; 48 -20.07974</span></span>
<span><span class="co">#&gt; 18 -28.20888</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="which-output-values-should-you-use">Which output values should you use?<a class="anchor" aria-label="anchor" href="#which-output-values-should-you-use"></a>
</h3>
<p>Instead of looking at pathway enrichment, SCPA assesses changes in
the multivariate distribution of a pathway. However, pathways that show
enrichment in a given population will also necessarily show large
changes in multivariate distribution. This means that with SCPA you’re
able to detect 1) enriched pathways and 2) non-enriched pathways that
have transcriptional changes that are independent of enrichment. This
output is reflected in the qval, and we recommend people to use this as
their primary statistic. Here, the larger the qval, the larger the
change in pathway ‘activity’. As SCPA measures multivariate
distributions, there will be pathways that show significantly large
qvals, but no overall fold change/enrichment in a given population.
Whilst these pathways are not enriched, we know that these distribution
changes identified by SCPA are still important for cellular behavior. We
show an example of this in Figure 4 <a href="https://www.cell.com/cell-reports/fulltext/S2211-1247(22)01571-6" class="external-link">our
paper</a>, where arachidonic acid metabolism is not enriched, but shows
changes in multivariate distribution, and is shown to be critical for T
cell activation. We are therefore proposing that considering changes in
multivariate distributions of pathways is a better overall reflection of
pathway activity, and because of this, you should use the qval as your
statistical measurement of pathway activity, and fold change only as a
secondary informative value.</p>
</div>
<div class="section level3">
<h3 id="filtering-and-visualizing-the-scpa-output">Filtering and visualizing the SCPA output<a class="anchor" aria-label="anchor" href="#filtering-and-visualizing-the-scpa-output"></a>
</h3>
<p>In general, it’s most informative to visualize the whole output of
the pathway analysis so you can understand the global pattern of pathway
changes that are occurring in your populations. So whilst you can use a
typical statistical filter e.g. adjusted pval &lt; 0.01, we generally
propose using something like a ranking plot to visualize thw
distribution of qvals, whilst still being able to highlight certain
pathways. We provide some basic functions including
<code><a href="../reference/plot_rank.html">plot_rank()</a></code> that can visualize the SCPA output like this,
and also provide the <code><a href="../reference/plot_heatmap.html">plot_heatmap()</a></code> function that can
visualize more than one comparison. See the <a href="https://jackbibby1.github.io/SCPA/articles/visualisation.html">Visualization
tutorial</a> for some examples of this.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jack Bibby, Divyansh Agarwal.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
