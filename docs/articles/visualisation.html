<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualisation • Single Cell Pathway Analysis (SCPA)</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Visualisation">
<meta property="og:description" content="SCPA">
<meta property="og:image" content="jackbibby1.github.io/SCPA/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-W1XR84YEPZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-W1XR84YEPZ');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Single Cell Pathway Analysis (SCPA)</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">General information</li>
    <li>
      <a href="../articles/interpreting_scpa_output.html">Interpreting the SCPA output</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Generic example</li>
    <li>
      <a href="../articles/quick_start.html">Quick start</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Speeding up SCPA</li>
    <li>
      <a href="../articles/parallel_implementation.html">Parallel processing for faster analysis</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Interacting with gene sets</li>
    <li>
      <a href="../articles/using_gene_sets.html">Using gene sets</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Specific examples</li>
    <li>
      <a href="../articles/comparing_two_populations.html">Comparing two populations</a>
    </li>
    <li>
      <a href="../articles/seurat_comparison.html">Seurat/SingleCellExperiment comparison</a>
    </li>
    <li>
      <a href="../articles/pseudotime.html">Comparing across pseudotime</a>
    </li>
    <li>
      <a href="../articles/systematic_tissue_comparison.html">Systematic comparisons of cells across tissue</a>
    </li>
    <li>
      <a href="../articles/disease_comparison.html">Systems level pathway analysis in disease</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Visualisation</li>
    <li>
      <a href="../articles/visualisation.html">Visualising SCPA output</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jackbibby1/SCPA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualisation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jackbibby1/SCPA/blob/HEAD/vignettes/visualisation.Rmd" class="external-link"><code>vignettes/visualisation.Rmd</code></a></small>
      <div class="hidden name"><code>visualisation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="visualising-the-output-from-scpa">Visualising the output from SCPA<a class="anchor" aria-label="anchor" href="#visualising-the-output-from-scpa"></a>
</h2>
<p>Visualising the output from SCPA is best done by considering the
relative ranks of the qvals. This will give you the best chance to find
the most appropriate signal.</p>
<p>Lets load in some packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jackbibby1/SCPA/" class="external-link">SCPA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span></code></pre></div>
<p>We can use data from the comparison we did in the <a href="https://jackbibby1.github.io/SCPA/articles/quick_start.html">quick
start</a> tutorial where we compared Th1 and Tcm cells. You can get this
rds file <a href="https://github.com/jackbibby1/SCPA/tree/main/rds_files" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scpa_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"th1_tcm.rds"</span><span class="op">)</span></span></code></pre></div>
<p><code>scpa_out</code> is the standard output from a two sample SCPA
comparison:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scpa_out</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               Pathway          Pval      adjPval     qval</span></span>
<span><span class="co">#&gt; 32            HALLMARK_MYC_TARGETS_V1 5.788383e-101 2.894192e-99 9.926655</span></span>
<span><span class="co">#&gt; 2        HALLMARK_ALLOGRAFT_REJECTION  7.532277e-93 3.766139e-91 9.509159</span></span>
<span><span class="co">#&gt; 31          HALLMARK_MTORC1_SIGNALING  7.532277e-93 3.766139e-91 9.509159</span></span>
<span><span class="co">#&gt; 36 HALLMARK_OXIDATIVE_PHOSPHORYLATION  1.061001e-89 5.305003e-88 9.342126</span></span>
<span><span class="co">#&gt; 23       HALLMARK_IL2_STAT5_SIGNALING  1.315549e-86 6.577745e-85 9.175071</span></span>
<span><span class="co">#&gt; 33            HALLMARK_MYC_TARGETS_V2  1.435838e-83 7.179192e-82 9.007992</span></span>
<span><span class="co">#&gt;           FC</span></span>
<span><span class="co">#&gt; 32 -87.81108</span></span>
<span><span class="co">#&gt; 2  -21.07656</span></span>
<span><span class="co">#&gt; 31 -45.82991</span></span>
<span><span class="co">#&gt; 36 -47.98635</span></span>
<span><span class="co">#&gt; 23 -20.23701</span></span>
<span><span class="co">#&gt; 33 -20.71347</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-simple-rank-plot">1. A simple rank plot<a class="anchor" aria-label="anchor" href="#a-simple-rank-plot"></a>
</h2>
<p>We can use the <code>plot_rank</code> function in SCPA to plot the
rank of a specific pathway (or pathways) that we want to highlight. By
default, this looks for a <code>qval</code> and <code>Pathway</code>
column, which is standard in the SCPA output.</p>
<p>If you have your own data frame that contains all your qvals and a
Pathway column, you can specify the column you want on the y axis with
the <code>population_name = [your_qval_column_name]</code> argument. See
<code><a href="../reference/plot_rank.html">?plot_rank</a></code> for all the graphical parameters, but this is a
ggplot object, so you can modify it using the typical arguments
e.g. <code>+ theme(panel.background...)</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if you want all pathways that contain "MYC"...</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_rank.html">plot_rank</a></span><span class="op">(</span><span class="va">scpa_out</span>, <span class="st">"myc"</span>, </span>
<span>                highlight_point_size <span class="op">=</span> <span class="fl">3.5</span>, highlight_point_color <span class="op">=</span> <span class="st">"#60c5f7"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or if you want a specific myc pathway...</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_rank.html">plot_rank</a></span><span class="op">(</span><span class="va">scpa_out</span>, <span class="st">"HALLMARK_MYC_TARGETS_V1"</span>,</span>
<span>                highlight_point_size <span class="op">=</span> <span class="fl">3.5</span>, highlight_point_color <span class="op">=</span> <span class="st">"#fa815c"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/rank_plot.png" style="width:80.0%"></p>
</div>
<div class="section level2">
<h2 id="plotting-a-heatmap-of-results">2. Plotting a heatmap of results<a class="anchor" aria-label="anchor" href="#plotting-a-heatmap-of-results"></a>
</h2>
<p>You can use the <code>plot_heatmap</code> option within SCPA to
visualise the output, which uses the great <a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a>
package. Like the <code>plot_rank</code> function, you can choose to
highlight general or specific pathways. By default, this function looks
for any column names that contain “qval”, and uses them to plot the
heatmap. This means you can combine muliple SCPA results into a single
heatmap. See <code><a href="../reference/plot_heatmap.html">?plot_heatmap</a></code> for graphical parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span><span class="va">scpa_out</span>, </span>
<span>             highlight_pathways <span class="op">=</span> <span class="st">"myc"</span>,</span>
<span>             column_names <span class="op">=</span> <span class="st">"Th1 vs Tcm"</span>,</span>
<span>             show_row_names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/heatmap_1.png" style="width:40.0%"></p>
<p>If you want to combine multiple scpa outputs into a single heatmap,
you can add your qvals into a single data frame. You just need to make
sure the column you’re adding contains “qval” in its name e.g.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here we'll just duplicate the qval column for the purpose of this example</span></span>
<span><span class="va">scpa_out</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>another_qval <span class="op">=</span> <span class="va">qval</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>highlight_pathways <span class="op">=</span> <span class="st">"myc"</span>,</span>
<span>               hm_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#5ab0f2"</span>, <span class="st">"white"</span>, <span class="st">"#be67c9"</span><span class="op">)</span>,</span>
<span>               column_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First qval"</span>, <span class="st">"Second qval"</span><span class="op">)</span>,</span>
<span>               cluster_columns <span class="op">=</span> <span class="cn">F</span>,</span>
<span>               show_row_names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/heatmap_2.png" style="width:50.0%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jack Bibby, Divyansh Agarwal.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
